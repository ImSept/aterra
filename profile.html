<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Absurd Territory</title>

<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name="viewport" content="width=420, initial-scale=1.0, maximum-scale=1.0, user-scalable=1" />

<link href="styles.css" rel="stylesheet" type="text/css">
<link href="burnig_circle.css" rel="stylesheet" type="text/css">
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="init_tg.js"></script>
<script src="swipe.js"></script>
<script src="load_and_fill.js"></script>

<script>
var user_id = '';
try {
	user_id = JSON.parse(new URLSearchParams(window.Telegram.WebApp.initData).get('user')).id;
}
catch (e) {
	alert(e);
	user_id = '920624208';
}

function RunFormater(){
	numerics = document.querySelectorAll('numeric');

	[...numerics].forEach(numeric => {
	    var num = parseFloat(numeric.innerHTML)
		if (num.toString() == numeric.innerHTML) {
			numeric.innerHTML = parseFloat(numeric.innerHTML).toLocaleString().replace(',', '.');
		}	
	});

}

document.addEventListener('DOMContentLoaded', () => {
	// пальцеп туды сюды
	new Swiper('#', 'https://imsept.github.io/aterra/index.html');	
	
	
	let ServerDataLoader = new DataLoader({'cmd':'profile', 'id':user_id}, (data) => {
		if (data['alliance_caption'] != '') document.querySelector('[alliance]').style.display = 'flex';
		RunFormater();		
	});
 
	document.querySelector('[leader_board]').addEventListener('click', () => {

		new DataLoader({'cmd': 'users_rate', 'id':'920624208'}, (data) => {
			if (Object.keys(data).length != 0) {
				content_block = '';
				for (let x in data['list_rate']) {
					content_block += "<div class=grid_tbl style='min-height:20px;'>";
					content_block += "<p style='min-width:25px !important;'>#" + (parseInt(x)+1).toString() + "</p>";
					content_block += "<numeric style='width:100px'>" + data['list_rate'][x][1] + "</numeric>";
					content_block += "<numeric style='width:100%;text-align:left'>" + data['list_rate'][x][0] + "</numeric>";
					
					content_block += "<lnk style='width:200px;text-align:right'>" + (data['list_rate'][x][2] != '' ? '@'+data['list_rate'][x][2] : '') + "</lnk>";
					content_block += "</div>";	
				
				}
				document.querySelector("[users_rate_table]").innerHTML = content_block;
				document.querySelector('.main').className = 'main_blured'; 
				document.querySelector('[users_rate_msg]').style.display = 'flex';				
				


			};
			
		}, false);
		
	}); 
	
var showDialogButtons = document.querySelectorAll('[close_msg]');

[...showDialogButtons].forEach(closeDialogButton =>
  closeDialogButton.addEventListener('click', function() {
	document.querySelector('.main_blured').className = 'main'; 
	document.querySelector('[users_rate_msg]').style.display = 'none';
	//document.querySelector('[up_power_msg]').style.display = 'none';
	//document.querySelector('[buildings]').style.display = 'none';
	//document.querySelector('[nfts]').style.display = 'none';
  }));	
	
  
});
</script>

</head>

<body>

<div class=message style='display:none' users_rate_msg>
	<div class=message_content>
		<div class=block_info_title>Leader board</div>
		<div class=content users_rate_table></div>
		
		<div class=footer>
			<a href=# class=row close_msg>Close</a>
		</div>
	</div>
</div>

<div class="main">
	<div class=grtop></div>
	<div class=grbot></div>
	<img class=back src='imgs\profile.jpg'>
	
	<div>
	<div class=title>Profile <div class=user_name tg_name>Svejak38</div><div class=wallet wallet>dfg...sfd</div></div>	
	</div>
	<div class=content>

		<div class=profile>
			<div class=block_info style="gap: 0px;">
				<div class=grid_tbl>
					<p><b>Balance:</b></p>
					<p><numeric balance>25.33</numeric> <token>$ATERRA</token></p>
				</div>
				<div class=grid_tbl>
					<p><b>Total resources:</b></p>
					<p><numeric total_res>5222</numeric></p>
				</div>
				<div class=grid_tbl>				
					<p><b>Claim cost:</b></p>
					<p><numeric claim_cost>0.5</numeric> <token>$ATERRA</token></p>
				</div>	
			</div>
			
			<div class=block_info style="gap: 0px; display:none" alliance>
				<div class=grid_tbl>
					<p><b>Alliance:</b></p>
					<p><lnk alliance_caption>@Lohi_vsei_zemli</lnk></p>
				</div>
				<div class=grid_tbl>
					<p><b>Alliance rate: <numeric>1233.5</numeric></p>
					<p style='display:none'><numeric style="color:red">#1</numeric> of <numeric>20</numeric> alliances</b></p>
				</div>
				<div class=grid_tbl>				
				<p><b>Member rank: <numeric personal_rang>54.4</numeric></p>
				<p style='display:none'><numeric style="color:red">#1</numeric> of <numeric>20</numeric> members</b></p>			
				</div>
			</div>
			
			<div class=block_info style="gap: 0px;">
				<div class=block_info_title>Personal</div>
				<div class=grid_tbl style='display:none'>
					<p><b>Growing rate:</b></p> 
					<p><b>More then <numeric>98%</numeric> users</b></p>
				</div>
				<div class=grid_tbl>						
					<p><b>Count territories:</b></p>
					<p><numeric count_territories>2</numeric></p>	
				</div>
				<div class=grid_tbl>						
					<p><b>Ready to claim:</b></p>
					<p><numeric count_ready>2</numeric></p>	
				</div>				
				<div class=grid_tbl>					
					<p><b>Borders:</b></p>
					<p><numeric count_borders>2</numeric></p>			
				</div>
				<div class=grid_tbl>					
					<p><b>Mean power:</b></p>
					<p><numeric mean_power>63%</numeric></p>			
				</div>
				<div class=grid_tbl>					
					<p><b>Mean level:</b></p>
					<p><numeric mean_level>4.5</numeric></p>			
				</div>
			</div>			
			
     
		</div>
	
	</div>
	<div>
		<div class=footer id=noborder>
			<a href='#' class=row id=no_active_button>Invite friend</a>
			<a href='#' class=row leader_board>Leader board</a>
			<a href='#' class=row id=no_active_button>NFT collections</a>
		</div>		
		<div class=footer>
			<a href='profile.html' class=row id=down>Profile</a>
			<a href='index.html' class=row>Absurd territories</a>
			<a href='resurces.html' class=row>Received resources</a>
			<a href='#' class=row id=no_active_button>Quests</a>
		</div>
	</div>
</div>

</body>
</html>